{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Hotel CCTV Monitoring{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    {% block extra_css %}{% endblock %}
</head>
<body>
    <div class="app-shell">
        <!-- Header -->
        <header class="top-bar">
            <div class="brand">관리자페이지</div>
            <div class="top-actions">
                <span class="user-info">{{ user.username }} ({{ user.get_role_display }})</span>
                <a href="{% url 'cctv:logout' %}" class="ghost-button small">로그아웃</a>
            </div>
        </header>

        <div class="layout {% if sidebar_collapsed %}layout-collapsed{% endif %}">
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <button class="collapse-btn" id="toggleSidebar" aria-label="사이드바 접기">
                        <
                    </button>
                </div>
                <nav class="nav-list">
                    {% if user.is_admin %}
                    <!-- Admin Navigation -->
                    <a href="{% url 'cctv:home' %}" class="nav-item {% if active_page == 'home' %}active{% endif %}">
                        <span class="nav-dot"></span>
                        <span class="nav-label">홈</span>
                    </a>
                    
                    <div class="nav-group">
                        <button class="nav-item nav-parent {% if 'monitor' in active_page %}active{% endif %}" onclick="toggleSubmenu('monitor')">
                            <span class="nav-dot"></span>
                            <span class="nav-label">실시간 모니터링</span>
                            <span class="caret" id="monitor-caret">⌄</span>
                        </button>
                        <div class="nav-sublist" id="monitor-submenu" style="display: {% if 'monitor' in active_page %}flex{% else %}none{% endif %}">
                            <a href="{% url 'cctv:monitor_all' %}" class="nav-item nav-sub {% if active_page == 'monitor-all' %}active{% endif %}">
                                <span class="nav-dot"></span>
                                <span class="nav-label">전지점</span>
                            </a>
                            <a href="{% url 'cctv:monitor_local' %}" class="nav-item nav-sub {% if active_page == 'monitor-local' %}active{% endif %}">
                                <span class="nav-dot"></span>
                                <span class="nav-label">현장</span>
                            </a>
                        </div>
                    </div>
                    
                    <div class="nav-group">
                        <button class="nav-item nav-parent {% if 'video' in active_page %}active{% endif %}" onclick="toggleSubmenu('video')">
                            <span class="nav-dot"></span>
                            <span class="nav-label">영상관리</span>
                            <span class="caret" id="video-caret">⌄</span>
                        </button>
                        <div class="nav-sublist" id="video-submenu" style="display: {% if 'video' in active_page %}flex{% else %}none{% endif %}">
                            <a href="{% url 'cctv:video_logs' %}" class="nav-item nav-sub {% if active_page == 'video-logs' %}active{% endif %}">
                                <span class="nav-dot"></span>
                                <span class="nav-label">이벤트 로그</span>
                            </a>
                            <a href="{% url 'cctv:video_full' %}" class="nav-item nav-sub {% if active_page == 'video-full' %}active{% endif %}">
                                <span class="nav-dot"></span>
                                <span class="nav-label">풀영상</span>
                            </a>
                        </div>
                    </div>
                    
                    <div class="nav-group">
                        <button class="nav-item nav-parent {% if 'manage' in active_page %}active{% endif %}" onclick="toggleSubmenu('manage')">
                            <span class="nav-dot"></span>
                            <span class="nav-label">관리</span>
                            <span class="caret" id="manage-caret">⌄</span>
                        </button>
                        <div class="nav-sublist" id="manage-submenu" style="display: {% if 'manage' in active_page %}flex{% else %}none{% endif %}">
                            <a href="{% url 'cctv:manage_branches' %}" class="nav-item nav-sub {% if active_page == 'manage-branches' %}active{% endif %}">
                                <span class="nav-dot"></span>
                                <span class="nav-label">지점관리</span>
                            </a>
                        </div>
                    </div>
                    
                    <a href="{% url 'cctv:reports' %}" class="nav-item {% if active_page == 'reports' %}active{% endif %}">
                        <span class="nav-dot"></span>
                        <span class="nav-label">기본 리포트</span>
                    </a>
                    
                    {% else %}
                    <!-- Project Manager Navigation -->
                    <div class="nav-group">
                        <button class="nav-item nav-parent {% if 'monitor' in active_page %}active{% endif %}" onclick="toggleSubmenu('monitor')">
                            <span class="nav-dot"></span>
                            <span class="nav-label">실시간 모니터링</span>
                            <span class="caret" id="monitor-caret">⌄</span>
                        </button>
                        <div class="nav-sublist" id="monitor-submenu" style="display: {% if 'monitor' in active_page %}flex{% else %}none{% endif %}">
                            <a href="{% url 'cctv:monitor_local' %}" class="nav-item nav-sub {% if active_page == 'monitor-local' %}active{% endif %}">
                                <span class="nav-dot"></span>
                                <span class="nav-label">현장</span>
                            </a>
                        </div>
                    </div>
                    
                    <div class="nav-group">
                        <button class="nav-item nav-parent {% if 'video' in active_page %}active{% endif %}" onclick="toggleSubmenu('video')">
                            <span class="nav-dot"></span>
                            <span class="nav-label">영상관리</span>
                            <span class="caret" id="video-caret">⌄</span>
                        </button>
                        <div class="nav-sublist" id="video-submenu" style="display: {% if 'video' in active_page %}flex{% else %}none{% endif %}">
                            <a href="{% url 'cctv:video_logs' %}" class="nav-item nav-sub {% if active_page == 'video-logs' %}active{% endif %}">
                                <span class="nav-dot"></span>
                                <span class="nav-label">이벤트 로그</span>
                            </a>
                            <a href="{% url 'cctv:video_full' %}" class="nav-item nav-sub {% if active_page == 'video-full' %}active{% endif %}">
                                <span class="nav-dot"></span>
                                <span class="nav-label">풀영상</span>
                            </a>
                        </div>
                    </div>
                    {% endif %}
                </nav>
            </aside>

            <!-- Main Content -->
            <main class="content">
                {% block content %}{% endblock %}
            </main>
        </div>
    </div>

    <!-- Modal Container -->
    <div id="modalContainer"></div>

    <script src="{% static 'js/main.js' %}"></script>
    {% block extra_js %}{% endblock %}
</body>
</html>
